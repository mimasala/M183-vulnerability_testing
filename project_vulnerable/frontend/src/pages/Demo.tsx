import {FormEventHandler, useEffect, useState} from "react";
import * as React from "react";
import Button from "@mui/material/Button";
import TextField from "@mui/material/TextField";
import {useAuth} from "../../hooks/useAuth.tsx";


export default function Demo() {
    const { getAuthToken } = useAuth()
    const [response, setResponse] = useState("")
    const [input, setInput] = useState("")
    const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {
        setInput(event.target.value);
    };
    const handleSubmit = async (event: any ) => {
        event.preventDefault()
        const res = await fetch('http://localhost:8080/api/v1/demo-controller/vulnerable?mal=' + encodeURI(input), {
            method: 'GET',
            headers: {
                'Authorization': `Bearer ${getAuthToken()}`,
            },
        });

        const data = await res.text();

        if (res.ok) {
            setResponse(data);
        } else {
            setResponse("Failed to fetch data");
        }
    }

    return (<>
        Hello from Demo
        <br/>
        <br/>
        <TextField id="outlined-basic" label="Outlined" variant="outlined" onChange={handleChange}/>
        <br/>
        <br/>
        <Button type="submit" onClick={handleSubmit}>Get Data</Button>
        <br/>
        <br/>
        {response}
    </>);
}